
# QGAM data:
require(qgam)
options(show.signif.stars=FALSE)

load("qgamDat.rda")

# Mid quartile points
qntls = seq(0.125, 0.875, by=0.375)

qgam1 = mqgam(LogMovingStdDev ~
    s(ScaledWordInTrial, by=LearnerType, k=3) +
    s(ScaledTrial, by=LearnerType, k=3) +
    s(Participant, bs='re') +
    s(StimulusID, bs='re'),
    data=qgamDat, qu=qntls)
qdo(qgam1, 0.125, summary)
# Parametric coefficients:
#             Estimate Std. Error z value Pr(>|z|)
# (Intercept) -3.22955    0.07107  -45.44   <2e-16

# Approximate significance of smooth terms:
#                                                      edf Ref.df  Chi.sq p-value
# s(ScaledWordInTrial):LearnerTypetask.sensitive     1.786  1.951   4.275  0.0825
# s(ScaledWordInTrial):LearnerTypebalanced           1.275  1.472   0.946  0.3573
# s(ScaledWordInTrial):LearnerTypecontent.sensitive  1.629  1.858   3.409  0.2440
# s(ScaledTrial):LearnerTypetask.sensitive           1.002  1.003   2.648  0.1040
# s(ScaledTrial):LearnerTypebalanced                 1.011  1.022   2.199  0.1441
# s(ScaledTrial):LearnerTypecontent.sensitive        1.002  1.004   0.000  0.9980
# s(Participant)                                    27.035 29.000 438.428  <2e-16
# s(StimulusID)                                      7.688 19.000  19.188  0.0152

# R-sq.(adj) =  0.117   Deviance explained = 55.9%
# -REML =  10888  Scale est. = 1         n = 6150

qdo(qgam1, 0.5, summary)
# Parametric coefficients:
#             Estimate Std. Error z value Pr(>|z|)
# (Intercept) -2.21327    0.07002  -31.61   <2e-16

# Approximate significance of smooth terms:
#                                                      edf Ref.df   Chi.sq  p-value
# s(ScaledWordInTrial):LearnerTypetask.sensitive     1.036  1.071    0.533 0.467544
# s(ScaledWordInTrial):LearnerTypebalanced           1.941  1.996   15.815 0.000308
# s(ScaledWordInTrial):LearnerTypecontent.sensitive  1.926  1.994   27.343 2.86e-06
# s(ScaledTrial):LearnerTypetask.sensitive           1.000  1.001   26.661 2.44e-07
# s(ScaledTrial):LearnerTypebalanced                 1.004  1.007    2.748 0.098793
# s(ScaledTrial):LearnerTypecontent.sensitive        1.019  1.037    1.969 0.161123
# s(Participant)                                    28.172 29.000 1098.362  < 2e-16
# s(StimulusID)                                     15.470 19.000  112.722 2.83e-14

# R-sq.(adj) =  0.143   Deviance explained = 13.9%
# -REML = 7752.5  Scale est. = 1         n = 6150

qdo(qgam1, 0.875, summary)
# Parametric coefficients:
#             Estimate Std. Error z value Pr(>|z|)
# (Intercept) -1.30867    0.07894  -16.58   <2e-16

# Approximate significance of smooth terms:
#                                                      edf Ref.df  Chi.sq  p-value
# s(ScaledWordInTrial):LearnerTypetask.sensitive     1.409  1.649   1.171 0.328693
# s(ScaledWordInTrial):LearnerTypebalanced           1.866  1.981  11.689 0.005242
# s(ScaledWordInTrial):LearnerTypecontent.sensitive  1.879  1.985  17.988 0.000327
# s(ScaledTrial):LearnerTypetask.sensitive           1.820  1.966  16.357 0.000157
# s(ScaledTrial):LearnerTypebalanced                 1.001  1.001   3.388 0.065719
# s(ScaledTrial):LearnerTypecontent.sensitive        1.002  1.003   2.454 0.117333
# s(Participant)                                    27.820 29.000 896.897  < 2e-16
# s(StimulusID)                                     16.608 19.000 336.007  < 2e-16

# R-sq.(adj) =  0.102   Deviance explained = 62.9%
# -REML =   9374  Scale est. = 1         n = 6150


